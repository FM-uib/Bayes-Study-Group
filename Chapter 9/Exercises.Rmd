---
title: "R Notebook"
output: html_notebook
---

## 1. Convert the ANOVA to an ANCOVA (analysis of covariance):
Within the fixed-effects ANOVA, add the effect on SVL of a continuous measure of
habitat quality that varies by individual snake (perhaps individuals in
better habitat are larger and more competitive). You may either recreate a
new dataset that contains such an effect or simply create a habitat covariate
(e.g., by drawing random numbers) and add it as a covariate into the
previous analysis.

```{r}
ngroups <- 5				                  # Number of populations
nsample <- 10			                	  # Number of snakes in each
pop.means <- c(50, 40, 45, 55, 60) 	  # Population mean SVL
sigma <- 3				                    # Residual sd
beta <- 20

n <- ngroups * nsample 			          # Total number of data points
eps <- rnorm(n, 0, sigma)	           	# Residuals 
x <- rep(1:5, rep(nsample, ngroups)) 	# Indicator for population
hab.cover <- runif(n, 0, 1)

means <- rep(pop.means, rep(nsample, ngroups))

X <- as.matrix(model.matrix(~ as.factor(x) + hab.cover -1)) # Create design matrix
y <- as.numeric(X %*% as.matrix(c(pop.means, beta)) + eps) # assemble -- NOTE: as.numeric ESSENTIAL for WinBUGS
#plot(hab.cover,y, col = x)
boxplot(y~x, col="grey", xlab="Population", ylab="SVL", main="", las = 1)
```


```{r}
boxplot(y~hab, col="grey", xlab="Habitat", ylab="SVL", main="", las = 1)
```

```{r}

```

2. Watch shrinkage happen: 
Population mean estimates under the random- effects ANOVA are shrunk toward the 
grand mean when compared with those under a fixed-effects model. 
First, watch this shrinkage by fitting a fixed-effects ANOVA to the random-effects
data simulated in Section 9.3.1.
Second, discard the data from 8 out of 10 snakes in one population and see
what happens to the estimate of that population mean.

```{r}

```

3. Swiss haredata: 
Compare mean observed population density among all
surveyed sites when treating years as replicates. Do this once assuming that
these populations corresponded to fixed effects; then repeat the analysis
assuming they are random effects.
